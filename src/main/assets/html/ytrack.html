<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style type="text/css">
        <!--
        html, body { height: 100%; border: 0; padding: 0 }
        -->
    </style>
    <script src="http://api-maps.yandex.ru/2.0-stable/?load=package.full&lang=ru-RU"
            type="text/javascript"></script>
    <script>

var map;
var start;
var finish;
var track;

function initialize() {
    var track_data = android.getTrack();

    var min_lat = 180;
    var max_lat = -180;
    var min_lon = 180;
    var max_lon = -180;

    var points = (track_data+"").split('|');
    for (var i in points){
        var p = points[i].split(',');
        var lat = parseFloat(p[0]);
        var lon = parseFloat(p[1]);
        if (lat < min_lat)
            min_lat = lat;
        if (lat > max_lat)
            max_lat = lat;
        if (lon < min_lon)
            min_lon = lon;
        if (lon > max_lon)
            max_lon = lon;
        points[i] = [ lat, lon ];
    }

    var lat = (min_lat + max_lat) / 2;
    var lon = (min_lon + max_lon) / 2;

    map = new ymaps.Map('map-canvas', {
        center: [ lat, lon ],
        zoom: 17,
        options: {
            adjustZoomOnTypeChange: true
        }
    });
    map.controls.add('zoomControl', { left: 5, top: 5 })
    map.setBounds([[min_lat, min_lon],[max_lat,max_lon]], {
        checkZoomRange: true
    });

    start = new ymaps.Placemark(points[0]);
    map.geoObjects.add(start);

    finish = new ymaps.Placemark(points[points.length - 1]);
    map.geoObjects.add(finish);

    track = new ymaps.Polyline(points, {        
    }, {
        strokeWidth: 2,
        strokeColor: '#000080'
    });
    map.geoObjects.add(track);
}

function saveTrack() {
    var bounds = map.getBounds();
    var ne = bounds[0];
    var sw = bounds[1]
    android.save(ne[0], sw[0], ne[1], sw[1]);
}

function shareTrack() {
    var bounds = map.getBounds();
    var ne = bounds[0];
    var sw = bounds[1]
    android.share(ne[0], sw[0], ne[1], sw[1]);

}

ymaps.ready(initialize);



    </script>
</head>
<body>
<div id="map-canvas" style="width: 100%; height: 100%"></div>
</body>
</html>